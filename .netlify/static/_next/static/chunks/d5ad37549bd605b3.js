(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},98183,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={assign:function(){return i},searchParamsToUrlQuery:function(){return o},urlQueryToSearchParams:function(){return l}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});function o(e){let t={};for(let[r,n]of e.entries()){let e=t[r];void 0===e?t[r]=n:Array.isArray(e)?e.push(n):t[r]=[e,n]}return t}function s(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function l(e){let t=new URLSearchParams;for(let[r,n]of Object.entries(e))if(Array.isArray(n))for(let e of n)t.append(r,s(e));else t.set(r,s(n));return t}function i(e,...t){for(let r of t){for(let t of r.keys())e.delete(t);for(let[t,n]of r.entries())e.append(t,n)}return e}},95057,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={formatUrl:function(){return l},formatWithValidation:function(){return c},urlObjectKeys:function(){return i}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let o=e.r(90809)._(e.r(98183)),s=/https?|ftp|gopher|file/;function l(e){let{auth:t,hostname:r}=e,n=e.protocol||"",a=e.pathname||"",l=e.hash||"",i=e.query||"",c=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?c=t+e.host:r&&(c=t+(~r.indexOf(":")?`[${r}]`:r),e.port&&(c+=":"+e.port)),i&&"object"==typeof i&&(i=String(o.urlQueryToSearchParams(i)));let u=e.search||i&&`?${i}`||"";return n&&!n.endsWith(":")&&(n+=":"),e.slashes||(!n||s.test(n))&&!1!==c?(c="//"+(c||""),a&&"/"!==a[0]&&(a="/"+a)):c||(c=""),l&&"#"!==l[0]&&(l="#"+l),u&&"?"!==u[0]&&(u="?"+u),a=a.replace(/[?#]/g,encodeURIComponent),u=u.replace("#","%23"),`${n}${c}${a}${u}${l}`}let i=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function c(e){return l(e)}},18581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return a}});let n=e.r(71645);function a(e,t){let r=(0,n.useRef)(null),a=(0,n.useRef)(null);return(0,n.useCallback)(n=>{if(null===n){let e=r.current;e&&(r.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(r.current=o(e,n)),t&&(a.current=o(t,n))},[e,t])}function o(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},18967,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={DecodeError:function(){return y},MiddlewareNotFoundError:function(){return v},MissingStaticPage:function(){return j},NormalizeError:function(){return b},PageNotFoundError:function(){return m},SP:function(){return g},ST:function(){return x},WEB_VITALS:function(){return o},execOnce:function(){return s},getDisplayName:function(){return d},getLocationOrigin:function(){return c},getURL:function(){return u},isAbsoluteUrl:function(){return i},isResSent:function(){return f},loadGetInitialProps:function(){return h},normalizeRepeatedSlashes:function(){return p},stringifyError:function(){return N}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let o=["CLS","FCP","FID","INP","LCP","TTFB"];function s(e){let t,r=!1;return(...n)=>(r||(r=!0,t=e(...n)),t)}let l=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,i=e=>l.test(e);function c(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function u(){let{href:e}=window.location,t=c();return e.substring(t.length)}function d(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function f(e){return e.finished||e.headersSent}function p(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function h(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await h(t.Component,t.ctx)}:{};let n=await e.getInitialProps(t);if(r&&f(r))return n;if(!n)throw Object.defineProperty(Error(`"${d(e)}.getInitialProps()" should resolve to an object. But found "${n}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return n}let g="u">typeof performance,x=g&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class y extends Error{}class b extends Error{}class m extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class j extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function N(e){return JSON.stringify({message:e.message,stack:e.stack})}},73668,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isLocalURL",{enumerable:!0,get:function(){return o}});let n=e.r(18967),a=e.r(52817);function o(e){if(!(0,n.isAbsoluteUrl)(e))return!0;try{let t=(0,n.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,a.hasBasePath)(r.pathname)}catch(e){return!1}}},84508,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"errorOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},22016,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={default:function(){return y},useLinkStatus:function(){return m}};for(var a in n)Object.defineProperty(r,a,{enumerable:!0,get:n[a]});let o=e.r(90809),s=e.r(43476),l=o._(e.r(71645)),i=e.r(95057),c=e.r(8372),u=e.r(18581),d=e.r(18967),f=e.r(5550);e.r(33525);let p=e.r(91949),h=e.r(73668),g=e.r(9396);function x(e){return"string"==typeof e?e:(0,i.formatUrl)(e)}function y(t){var r;let n,a,o,[i,y]=(0,l.useOptimistic)(p.IDLE_LINK_STATUS),m=(0,l.useRef)(null),{href:j,as:v,children:N,prefetch:T=null,passHref:E,replace:P,shallow:O,scroll:S,onClick:A,onMouseEnter:w,onTouchStart:k,legacyBehavior:C=!1,onNavigate:$,ref:_,unstable_dynamicOnHover:I,...R}=t;n=N,C&&("string"==typeof n||"number"==typeof n)&&(n=(0,s.jsx)("a",{children:n}));let U=l.default.useContext(c.AppRouterContext),L=!1!==T,M=!1!==T?null===(r=T)||"auto"===r?g.FetchStrategy.PPR:g.FetchStrategy.Full:g.FetchStrategy.PPR,{href:D,as:H}=l.default.useMemo(()=>{let e=x(j);return{href:e,as:v?x(v):e}},[j,v]);if(C){if(n?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});a=l.default.Children.only(n)}let K=C?a&&"object"==typeof a&&a.ref:_,F=l.default.useCallback(e=>(null!==U&&(m.current=(0,p.mountLinkInstance)(e,D,U,M,L,y)),()=>{m.current&&((0,p.unmountLinkForCurrentNavigation)(m.current),m.current=null),(0,p.unmountPrefetchableInstance)(e)}),[L,D,U,M,y]),B={ref:(0,u.useMergedRef)(F,K),onClick(t){C||"function"!=typeof A||A(t),C&&a.props&&"function"==typeof a.props.onClick&&a.props.onClick(t),!U||t.defaultPrevented||function(t,r,n,a,o,s,i){if("u">typeof window){let c,{nodeName:u}=t.currentTarget;if("A"===u.toUpperCase()&&((c=t.currentTarget.getAttribute("target"))&&"_self"!==c||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,h.isLocalURL)(r)){o&&(t.preventDefault(),location.replace(r));return}if(t.preventDefault(),i){let e=!1;if(i({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:d}=e.r(99781);l.default.startTransition(()=>{d(n||r,o?"replace":"push",s??!0,a.current)})}}(t,D,H,m,P,S,$)},onMouseEnter(e){C||"function"!=typeof w||w(e),C&&a.props&&"function"==typeof a.props.onMouseEnter&&a.props.onMouseEnter(e),U&&L&&(0,p.onNavigationIntent)(e.currentTarget,!0===I)},onTouchStart:function(e){C||"function"!=typeof k||k(e),C&&a.props&&"function"==typeof a.props.onTouchStart&&a.props.onTouchStart(e),U&&L&&(0,p.onNavigationIntent)(e.currentTarget,!0===I)}};return(0,d.isAbsoluteUrl)(H)?B.href=H:C&&!E&&("a"!==a.type||"href"in a.props)||(B.href=(0,f.addBasePath)(H)),o=C?l.default.cloneElement(a,B):(0,s.jsx)("a",{...R,...B,children:n}),(0,s.jsx)(b.Provider,{value:i,children:o})}e.r(84508);let b=(0,l.createContext)(p.IDLE_LINK_STATUS),m=()=>(0,l.useContext)(b);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},52262,e=>{"use strict";var t=e.i(43476),r=e.i(71645),n=e.i(22016);let a=0;function o(){let[e,o]=(0,r.useState)("DemoAgent"),[u,d]=(0,r.useState)([]),[f,p]=(0,r.useState)(null),[h,g]=(0,r.useState)(!1),[x,y]=(0,r.useState)(!1),b=(0,r.useRef)(null);(0,r.useEffect)(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight)},[u]);let m=(0,r.useCallback)((e,t)=>{d(r=>[...r,{id:a++,direction:e,content:t}])},[]),j=(0,r.useCallback)(()=>{d([]),p(null),a=0},[]),v=(0,r.useCallback)(async()=>{j(),g(!0);try{m("info",`Starting fishnet-auth flow for agent "${e}"`),m("out",`POST /api/demo/solve  { "name": "${e}" }`);let t=await fetch("/api/demo/solve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}),r=await t.json();for(let e of r.steps){if("discovery"===e.step){let t=e.detail;m("in",`DISCOVERY  seed=${t.seed}  tasks=${t.taskCount}  minCorrect=${t.minCorrect}`),m("info",`Task types: ${t.taskTypes.join(", ")}`)}if("solved"===e.step)for(let t of e.detail.tasks){let e="string"==typeof t.input?t.input:JSON.stringify(t.input);m("info",`[${t.type}]  input: ${e}`),m("ok",`  answer: ${t.answer}`)}if("authenticated"===e.step){let t=e.detail;m("ok",`AUTHENTICATED  agentId=${t.agentId}`),m("ok",`API Key: ${t.apiKey}`),m("info",`Expires: ${t.expiresAt}`)}"failed"===e.step&&m("error",`AUTH FAILED: ${JSON.stringify(e.detail)}`)}r.success&&r.apiKey&&(p(r.apiKey),m("info","Agent can now access protected endpoints with this bearer token."))}catch(e){m("error",`Request failed: ${String(e)}`)}finally{g(!1)}},[e,m,j]),N=(0,r.useCallback)(async()=>{y(!0);let e={};f?(e.Authorization=`Bearer ${f}`,m("out",`GET /api/agent-auth/protected  Authorization: Bearer ${f.slice(0,16)}...`)):m("out","GET /api/agent-auth/protected  (no auth token)");try{let t=await fetch("/api/agent-auth/protected",{headers:e}),r=await t.json();if(!t.ok){m("error",`HTTP ${t.status}: ${JSON.stringify(r)}`),f||m("info","Protected endpoint rejected the request. Authenticate an agent first.");return}m("ok",`${r.message}`),m("in",JSON.stringify(r.agent,null,2))}catch(e){m("error",`Protected request failed: ${String(e)}`)}finally{y(!1)}},[f,m]);return(0,t.jsx)("div",{className:"min-h-screen bg-black text-white font-mono",children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto p-6",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)(n.default,{href:"/",className:"text-gray-500 hover:text-gray-300 text-sm transition-colors",children:"← Back"}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-blue-400 mt-4 tracking-tight",children:"FISHNET-AUTH DEMO"}),(0,t.jsx)("p",{className:"text-gray-400 mt-2 max-w-2xl text-sm leading-relaxed",children:"Reverse CAPTCHA for AI agents. The server generates reasoning tasks that are trivial for an LLM but impractical for humans at speed. Agents solve the challenge with their own model, submit answers in a single POST, and receive credentials. Zero LLM cost on the server."})]}),(0,t.jsxs)("div",{className:"mb-8 p-4 border border-gray-800 bg-gray-950 rounded-lg text-xs text-gray-500 leading-relaxed",children:[(0,t.jsx)("div",{className:"text-gray-400 font-bold mb-2",children:"PROTOCOL"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)(s,{label:"1. Agent requests challenge"}),(0,t.jsx)(l,{}),(0,t.jsx)(s,{label:"2. Server returns seed + tasks"}),(0,t.jsx)(l,{}),(0,t.jsx)(s,{label:"3. Agent solves with LLM"}),(0,t.jsx)(l,{}),(0,t.jsx)(s,{label:"4. Agent POSTs answers"}),(0,t.jsx)(l,{}),(0,t.jsx)(s,{label:"5. Server verifies, issues API key"})]})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-5 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsxs)("div",{className:"border border-gray-800 bg-gray-950 rounded-lg p-4 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs text-gray-500 mb-1",children:"AGENT NAME"}),(0,t.jsx)("input",{type:"text",value:e,onChange:e=>o(e.target.value),className:"w-full bg-gray-900 border border-gray-700 text-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none rounded",placeholder:"Enter agent name"})]}),(0,t.jsx)("button",{onClick:v,disabled:h||!e.trim(),className:"w-full bg-blue-600 hover:bg-blue-500 disabled:bg-gray-800 disabled:text-gray-600 text-white px-4 py-3 text-sm font-bold transition-colors rounded",children:h?"RUNNING...":"RUN AGENT AUTHENTICATION"}),f&&(0,t.jsxs)("div",{className:"pt-2 border-t border-gray-800",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"ISSUED API KEY"}),(0,t.jsx)("div",{className:"bg-gray-900 border border-green-900 p-2 rounded text-green-400 text-xs break-all",children:f})]}),u.length>0&&(0,t.jsx)("button",{onClick:j,className:"w-full border border-gray-700 hover:border-gray-500 text-gray-500 hover:text-white px-4 py-2 text-xs transition-colors rounded",children:"RESET"})]}),(0,t.jsxs)("div",{className:`border rounded-lg p-4 space-y-3 ${f?"border-green-800/50 bg-green-950/10":"border-red-900/50 bg-red-950/10"}`,children:[(0,t.jsx)("div",{className:"text-xs text-gray-400 font-bold",children:"PROTECTED ENDPOINT"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:f?"Agent authenticated. This request will include the bearer token.":"No auth token. Hit this to see the 401 rejection, then authenticate to see it succeed."}),(0,t.jsx)("button",{onClick:N,disabled:x,className:`w-full px-4 py-2 text-sm font-bold transition-colors rounded ${f?"bg-green-700 hover:bg-green-600 text-white":"bg-red-900/50 hover:bg-red-900 border border-red-800 text-red-400"} disabled:bg-gray-800 disabled:text-gray-600`,children:x?"REQUESTING...":f?"TEST WITH AUTH TOKEN":"TEST WITHOUT AUTH (WILL FAIL)"})]}),(0,t.jsxs)("div",{className:"border border-gray-800 bg-gray-950 rounded-lg p-4 space-y-3",children:[(0,t.jsx)("div",{className:"text-xs text-gray-400 font-bold",children:"HOW AN AGENT AUTHENTICATES"}),(0,t.jsx)(c,{label:"1. Get challenge",cmd:`curl "http://localhost:3000/api/agent-auth?name=${e}"`}),(0,t.jsx)(c,{label:"2. Submit answers",cmd:`curl -X POST http://localhost:3000/api/agent-auth \\
  -H "Content-Type: application/json" \\
  -d '{"name":"${e}","seed":"SEED","answers":[...]}'`}),(0,t.jsx)(c,{label:"3. Use API key",cmd:`curl http://localhost:3000/api/agent-auth/protected \\
  -H "Authorization: Bearer YOUR_API_KEY"`})]})]}),(0,t.jsx)("div",{className:"lg:col-span-3",children:(0,t.jsxs)("div",{className:"border border-gray-800 bg-gray-950 rounded-lg overflow-hidden sticky top-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-800",children:[(0,t.jsx)("span",{className:"text-xs text-gray-400 font-bold",children:"AGENT AUTH LOG"}),u.length>0&&(0,t.jsxs)("span",{className:"text-xs text-gray-600",children:[u.length," entries"]})]}),(0,t.jsx)("div",{ref:b,className:"p-4 max-h-[75vh] overflow-y-auto space-y-1",children:0===u.length?(0,t.jsx)("p",{className:"text-gray-600 text-xs",children:'Click "Run Agent Authentication" to watch an agent prove it can think.'}):u.map(e=>(0,t.jsx)(i,{entry:e},e.id))})]})})]})]})})}function s({label:e}){return(0,t.jsx)("span",{className:"bg-gray-900 border border-gray-800 px-2 py-1 rounded text-xs",children:e})}function l(){return(0,t.jsx)("span",{className:"text-gray-700",children:"→"})}function i({entry:e}){let r={out:{color:"text-blue-400",prefix:">>>"},in:{color:"text-gray-300",prefix:"<<<"},info:{color:"text-yellow-400",prefix:"---"},error:{color:"text-red-400",prefix:"ERR"},ok:{color:"text-green-400",prefix:" ok"}}[e.direction];return(0,t.jsxs)("div",{className:"text-xs flex items-start gap-2",children:[(0,t.jsx)("span",{className:`${r.color} font-bold shrink-0 w-7 text-right`,children:r.prefix}),(0,t.jsx)("pre",{className:`${r.color} whitespace-pre-wrap break-all`,children:e.content})]})}function c({label:e,cmd:r}){return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-500 text-xs mb-1",children:e}),(0,t.jsx)("pre",{className:"bg-gray-900 p-2 rounded text-green-400 text-xs whitespace-pre-wrap break-all",children:r})]})}e.s(["default",()=>o])}]);