module.exports=[32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},66680,(e,t,r)=>{t.exports=e.x("node:crypto",()=>require("node:crypto"))},60873,e=>{"use strict";let t,r,n;var a=e.i(66680);function s(e,t,r){let n=Math.floor((r??Date.now())/(1e3*t)),a=i(e,n),s=i(e,n-1);return{seed:a,expiresAt:new Date((n+1)*t*1e3).toISOString(),previousSeed:s}}function i(e,t){return(0,a.createHmac)("sha256",e).update(`fishnet-auth:seed:${t}`).digest("hex").slice(0,12)}let o=["quantum","nebula","prism","velvet","cascade","ember","fractal","horizon","lattice","mosaic","oracle","pulse","ripple","sigma","tensor","vortex","apex","bloom","cipher","drift","flux","glyph","helix","ionic","jade","knot","lumen","matrix","nova","onyx","pyre","quasar","reef","shard","tide","umbra","vivid","warp","xenon","zephyr","abyss","bolt","crest","dune","echo","forge","gleam","haze","iota","jolt","karma","lunar","myth","nexus","opal","plume"],l="abcdefghijklmnopqrstuvwxyz";function c(e,t,r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"){let n="";for(let a=0;a<t;a++)n+=r[e.int(0,r.length)];return n}function u(e,t){let r=[],n=[...o];for(let a=0;a<t&&n.length>0;a++){let t=e.int(0,n.length);r.push(n[t]),n.splice(t,1)}return r}let d={easy:["easy"],standard:["easy","standard"],hard:["easy","standard","hard"]};function p(e,t){if(!t)return e;let r=new Set(d[t]);return e.filter(e=>r.has(e.difficulty))}let h=[{type:"reverse",difficulty:"easy",generate(e){let t=c(e,e.int(8,16));return{type:"reverse",instruction:"Reverse this string exactly.",input:t,answer:t.split("").reverse().join("")}},verify:(e,t)=>t===e.answer},{type:"nthWord",difficulty:"standard",generate(e){let t=e.int(8,15),r=u(e,t),n=e.int(1,t+1);return{type:"nthWord",instruction:`What is word number ${n} in this list? (1-indexed)`,input:r,answer:r[n-1]}},verify:(e,t)=>t.trim().toLowerCase()===e.answer.toLowerCase()},{type:"jsonBuild",difficulty:"standard",generate(e){let t=u(e,e.int(4,7)),r={};for(let e of t)r[e]=e.length;let n={};for(let e of Object.keys(r).sort())n[e]=r[e];return{type:"jsonBuild",instruction:"Create a JSON object where each word is a key and its value is the word's character count. Sort keys alphabetically. Return compact JSON (no spaces).",input:t,answer:JSON.stringify(n)}},verify(e,t){try{let r=JSON.parse(t.trim()),n=JSON.parse(e.answer);return JSON.stringify(r)===JSON.stringify(n)}catch{return!1}}},{type:"arraySort",difficulty:"easy",generate(e){let t=u(e,e.int(6,12)),r=e.shuffle(t),n=[...r].sort();return{type:"arraySort",instruction:"Sort these strings alphabetically and return them comma-separated with no spaces.",input:r,answer:n.join(",")}},verify:(e,t)=>t.trim().replace(/\s/g,"")===e.answer},{type:"caesarShift",difficulty:"standard",generate(e){let t=c(e,e.int(6,12),l),r=e.int(1,26),n=t.split("").map(e=>String.fromCharCode((e.charCodeAt(0)-97+r)%26+97)).join("");return{type:"caesarShift",instruction:`Shift each letter in the string forward by ${r} position(s) in the alphabet, wrapping z back to a. Return the resulting string.`,input:t,answer:n}},verify:(e,t)=>t.trim().toLowerCase()===e.answer},{type:"pattern",difficulty:"easy",generate(e){let t=e.int(2,5),r=[];for(let n=0;n<t;n++)r.push(l[e.int(0,l.length)]);let n=[];for(let e=0;e<3;e++)for(let e of r)n.push(e);let a=r.join(",");return{type:"pattern",instruction:`This sequence repeats a pattern. What are the next ${t} elements? Return comma-separated, no spaces.`,input:n.join(","),answer:a}},verify:(e,t)=>t.trim().replace(/\s/g,"")===e.answer},{type:"transform",difficulty:"standard",generate(e){let t=c(e,e.int(6,10),l),r=[],n=t,a=e.shuffle([{name:"uppercase",apply:e=>e.toUpperCase(),desc:"Convert to uppercase"},{name:"reverse",apply:e=>e.split("").reverse().join(""),desc:"Reverse the string"},{name:"remove_vowels",apply:e=>e.replace(/[aeiouAEIOU]/g,""),desc:"Remove all vowels"},{name:"double",apply:e=>e+e,desc:"Concatenate the string with itself"},{name:"first_half",apply:e=>e.slice(0,Math.ceil(e.length/2)),desc:"Take only the first half (round up)"}]),s=e.int(2,4);for(let e=0;e<s;e++){let t=a[e];r.push(t.desc),n=t.apply(n)}return{type:"transform",instruction:`Start with the string below. Apply these steps in order:
${r.map((e,t)=>`${t+1}. ${e}`).join("\n")}
Return the final result.`,input:t,answer:n}},verify:(e,t)=>t.trim()===e.answer},{type:"firstLetters",difficulty:"easy",generate(e){let t=u(e,e.int(8,15)),r=t.map(e=>e[0]).join("");return{type:"firstLetters",instruction:"Take the first letter of each word and concatenate them into a single string.",input:t,answer:r}},verify:(e,t)=>t.trim().toLowerCase()===e.answer.toLowerCase()},{type:"wordLengths",difficulty:"standard",generate(e){let t=u(e,e.int(6,12)),r=t.map(e=>String(e.length)).join(",");return{type:"wordLengths",instruction:"Return the character count of each word as comma-separated numbers, no spaces.",input:t,answer:r}},verify:(e,t)=>t.trim().replace(/\s/g,"")===e.answer},{type:"filterWords",difficulty:"standard",generate(e){let t=u(e,e.int(10,18)),r=e.int(3,6),n=t.filter(e=>e.length>r).sort();for(;0===n.length&&r>1;)r--,n=t.filter(e=>e.length>r).sort();return{type:"filterWords",instruction:`Return only the words with more than ${r} characters, sorted alphabetically, comma-separated, no spaces.`,input:t,answer:n.join(",")}},verify:(e,t)=>t.trim().replace(/\s/g,"")===e.answer},{type:"interleave",difficulty:"easy",generate(e){let t=e.int(4,8),r=c(e,t,l),n=c(e,t,l),a="";for(let e=0;e<t;e++)a+=r[e]+n[e];return{type:"interleave",instruction:"Interleave the characters of these two strings (take one from each, alternating, starting with the first string).",input:{first:r,second:n},answer:a}},verify:(e,t)=>t.trim()===e.answer}],f=new Map;for(let e of h)f.set(e.type,e);function g(e,t){return p(e?e.map(e=>f.get(e)).filter(e=>void 0!==e):h,t)}let y="standard";function m(e,t,r,n,s=5,i=y){let o=function(e,t){let r=(0,a.createHmac)("sha256",e).update(`fishnet-auth:rng:${t}`).digest().readUInt32BE(0);function n(){r|=0;let e=Math.imul((r=r+0x6d2b79f5|0)^r>>>15,1|r);return(((e=e+Math.imul(e^e>>>7,61|e)^e)^e>>>14)>>>0)/0x100000000}function s(e,t){return Math.floor(n()*(t-e))+e}return{next:n,int:s,pick:function(e){return e[s(0,e.length)]},shuffle:function(e){let t=[...e];for(let e=t.length-1;e>0;e--){let r=s(0,e+1);[t[e],t[r]]=[t[r],t[e]]}return t}}}(t,r),l=g(n,i);if(0===l.length)throw Error("No valid task types configured for the selected difficulty");let c=[];for(let e=0;e<s;e++){let e=l[o.int(0,l.length)];c.push(e.generate(o))}return c}class w{config;constructor(e){const t=e.taskCount??5,r=e.minCorrect??t;if(r<1||r>t)throw Error(`minCorrect must be between 1 and taskCount (${t}), got ${r}`);this.config={secret:e.secret,adapter:e.adapter,taskCount:t,minCorrect:r,seedRotationSeconds:e.seedRotationSeconds??300,difficulty:e.difficulty??y,credentialPrefix:e.credentials?.prefix??"ag_",credentialType:e.credentials?.type??"api-key",expiresInMs:function(e){let t=e.match(/^(\d+)([smhd])$/);if(!t)return 6048e5;let r=parseInt(t[1],10),n=t[2],a={s:1e3,m:6e4,h:36e5,d:864e5};return r*(a[n]||a.d)}(e.credentials?.expiresIn??"7d"),taskTypes:e.taskTypes??function(e){return p(h,e).map(e=>e.type)}(e.difficulty??y),onVerified:e.onVerified,onFailed:e.onFailed}}getDiscovery(e){let t=s(this.config.secret,this.config.seedRotationSeconds),r={version:"0.1",seed:t.seed,seedExpiresAt:t.expiresAt,taskTypes:this.config.taskTypes,taskCount:this.config.taskCount,minCorrect:this.config.minCorrect,authEndpoint:"/api/agent-auth",tasks:[]};return e&&(r.tasks=m(this.config.secret,t.seed,e,this.config.taskTypes,this.config.taskCount,this.config.difficulty).map(({type:e,instruction:t,input:r})=>({type:e,instruction:t,input:r}))),r}async authenticate(e){var t;let r,{name:n,seed:i,answers:o}=e;if(!n||"string"!=typeof n||n.length<1||n.length>64)return{success:!1,error:{error:"invalid_name",message:"Agent name must be 1-64 characters."}};if(!function(e,t,r,n){let{seed:a,previousSeed:i}=s(e,t,void 0);return r===a||r===i}(this.config.secret,this.config.seedRotationSeconds,i))return{success:!1,error:{error:"invalid_seed",message:"Seed is expired or invalid."}};if(await this.config.adapter.hasCompletedAuth(i,n))return{success:!1,error:{error:"replay_detected",message:"This seed has already been used for this agent name."}};let l=function(e,t,r,n,a,s=5,i,o=y){let l=m(e,t,r,a,s,o),c=i??l.length;if(n.length!==l.length)return{valid:!1,expected:l.length,correct:0,minCorrect:c};let u=new Map(g(a,o).map(e=>[e.type,e])),d=0;for(let e=0;e<l.length;e++){let t=l[e],r=u.get(t.type);r&&r.verify(t,n[e])&&d++}return{valid:d>=c,expected:l.length,correct:d,minCorrect:c}}(this.config.secret,i,n,o,this.config.taskTypes,this.config.taskCount,this.config.minCorrect,this.config.difficulty);if(!l.valid)return await this.config.onFailed?.({name:n,reason:`Got ${l.correct}/${l.expected} correct (need ${l.minCorrect})`}),{success:!1,error:{error:"challenge_failed",message:`Incorrect answers. Got ${l.correct}/${l.expected} correct (need ${l.minCorrect}).`}};await this.config.adapter.markAuthCompleted(i,n);let c=`ag_${(0,a.randomUUID)().replace(/-/g,"").slice(0,16)}`,u=(t=this.config.credentialPrefix,r=(0,a.randomUUID)().replace(/-/g,"")+(0,a.randomUUID)().replace(/-/g,""),`${t}${r.slice(0,40)}`),d=new Date,p=new Date(d.getTime()+this.config.expiresInMs),h={id:c,name:n,apiKey:u,createdAt:d.toISOString(),expiresAt:p.toISOString()};return await this.config.adapter.createAgent(h),await this.config.onVerified?.({name:n,id:c}),{success:!0,data:{agentId:c,apiKey:u,expiresAt:p.toISOString()}}}async validateToken(e){if(!e)return null;let t=await this.config.adapter.getAgentByKey(e);return!t||new Date(t.expiresAt)<new Date?null:t}extractToken(e){if(!e)return null;let t=e.match(/^Bearer\s+(.+)$/i);return t?t[1]:null}}function v(e){let t=new w(e);return{handleDiscovery:async function(e){let r=new URL(e.url).searchParams.get("name")??void 0;return new Response(JSON.stringify(t.getDiscovery(r)),{status:200,headers:{"Content-Type":"application/json","Cache-Control":"public, max-age=60"}})},handleAuth:async function(e){let r;if("POST"!==e.method)return new Response(JSON.stringify({error:"method_not_allowed",message:"Use POST"}),{status:405,headers:{"Content-Type":"application/json"}});try{r=await e.json()}catch{return new Response(JSON.stringify({error:"invalid_body",message:"Request body must be valid JSON."}),{status:400,headers:{"Content-Type":"application/json"}})}if(!r.name||!r.seed||!Array.isArray(r.answers))return new Response(JSON.stringify({error:"missing_fields",message:"Request must include name, seed, and answers[]."}),{status:400,headers:{"Content-Type":"application/json"}});let n=await t.authenticate(r);return n.success?new Response(JSON.stringify(n.data),{status:200,headers:{"Content-Type":"application/json"}}):new Response(JSON.stringify(n.error),{status:401,headers:{"Content-Type":"application/json"}})},handleProtect:async function(e){let r=e.headers.get("Authorization"),n=t.extractToken(r);return n?await t.validateToken(n)?null:new Response(JSON.stringify({error:"unauthorized",message:"Invalid or expired token."}),{status:401,headers:{"Content-Type":"application/json"}}):new Response(JSON.stringify({error:"unauthorized",message:"Missing or invalid Authorization header."}),{status:401,headers:{"Content-Type":"application/json"}})},engine:t}}let x=process.env.FISHNET_AUTH_SECRET;if(!x)throw Error("FISHNET_AUTH_SECRET environment variable is required. Copy .env.example to .env.local and set a value.");let C={secret:x,adapter:(t=new Map,r=new Map,n=new Set,{async createAgent(e){t.set(e.apiKey,e),r.set(e.id,e)},getAgentByKey:async e=>t.get(e)??null,async revokeAgent(e){let n=r.get(e);n&&(t.delete(n.apiKey),r.delete(e))},hasCompletedAuth:async(e,t)=>n.has(`${e}:${t}`),async markAuthCompleted(e,t){n.add(`${e}:${t}`)}}),difficulty:"easy",taskCount:2,minCorrect:2,credentials:{type:"api-key",prefix:"agent_",expiresIn:"1d"}},{GET:R,POST:S,engine:k}=function(e){let{handleDiscovery:t,handleAuth:r,engine:n}=v(e);return{GET:t,POST:r,engine:n}}(C),A=function(e){let{engine:t}=v(e);return async function(e){let r=t.extractToken(e.headers.get("Authorization"));return r?t.validateToken(r):null}}({secret:C.secret,adapter:C.adapter});e.s(["GET",0,R,"POST",0,S,"engine",0,k,"getAgent",0,A],60873)},68581,e=>{"use strict";var t=e.i(47909),r=e.i(74017),n=e.i(96250),a=e.i(59756),s=e.i(61916),i=e.i(74677),o=e.i(69741),l=e.i(16795),c=e.i(87718),u=e.i(95169),d=e.i(47587),p=e.i(66012),h=e.i(70101),f=e.i(26937),g=e.i(10372),y=e.i(93695);e.i(52474);var m=e.i(220),w=e.i(89171),v=e.i(60873);async function x(e){let t;try{t=await e.json()}catch{return w.NextResponse.json({error:"invalid_body",message:"Request body must be valid JSON with a name field."},{status:400})}let r=t.name?.trim();if(!r)return w.NextResponse.json({error:"missing_name",message:"Provide a name for the agent."},{status:400});let n=[];function a(e,t){n.push({step:e,detail:t,timestamp:new Date().toISOString()})}let s=v.engine.getDiscovery(r);a("discovery",{seed:s.seed,seedExpiresAt:s.seedExpiresAt,taskCount:s.taskCount,minCorrect:s.minCorrect,authEndpoint:s.authEndpoint,taskTypes:s.tasks.map(e=>e.type)});let i=[],o=[];for(let e of s.tasks){let t=function(e){switch(e.type){case"reverse":return e.input.split("").reverse().join("");case"arraySort":return[...e.input].sort().join(",");case"pattern":return function(e){let t=e.split(",");for(let e=2;e<=Math.floor(t.length/2);e++){let r=t.slice(0,e),n=!0;for(let a=0;a<t.length;a++)if(t[a]!==r[a%e]){n=!1;break}if(n)return r.join(",")}return t.slice(0,Math.floor(t.length/3)).join(",")}(e.input);case"firstLetters":return e.input.map(e=>e[0]).join("");case"interleave":return function(e){let t="",r=Math.max(e.first.length,e.second.length);for(let n=0;n<r;n++)n<e.first.length&&(t+=e.first[n]),n<e.second.length&&(t+=e.second[n]);return t}(e.input);case"nthWord":return function(e,t){let r=e.match(/word\s+(?:number\s+)?(\d+)/i);return r?t[parseInt(r[1],10)-1]||"":t[0]}(e.instruction,e.input);case"jsonBuild":var t;return t=e.instruction,JSON.stringify(e.input);case"caesarShift":return function(e,t){let r=e.match(/(\d+)\s+position/i),n=r?parseInt(r[1],10):3;return t.split("").map(e=>/[a-z]/.test(e)?String.fromCharCode((e.charCodeAt(0)-97+n)%26+97):/[A-Z]/.test(e)?String.fromCharCode((e.charCodeAt(0)-65+n)%26+65):e).join("")}(e.instruction,e.input);case"transform":return function(e,t){let r=t,n=e.toLowerCase();return n.includes("reverse")&&(r=r.split("").reverse().join("")),n.includes("uppercase")&&(r=r.toUpperCase()),n.includes("lowercase")&&(r=r.toLowerCase()),r}(e.instruction,e.input);case"wordLengths":return e.input.map(e=>e.length.toString()).join(",");case"filterWords":return function(e,t){let r=e.match(/more than (\d+)/i)||e.match(/longer than (\d+)/i),n=r?parseInt(r[1],10):5;return t.filter(e=>e.length>n).sort().join(",")}(e.instruction,e.input);default:return""}}(e);i.push(t),o.push({type:e.type,instruction:e.instruction,input:e.input,answer:t})}a("solved",{tasks:o});let l=await v.engine.authenticate({name:r,seed:s.seed,answers:i});return l.success?(a("authenticated",{agentId:l.data.agentId,apiKey:l.data.apiKey,expiresAt:l.data.expiresAt}),w.NextResponse.json({success:!0,agentId:l.data.agentId,apiKey:l.data.apiKey,expiresAt:l.data.expiresAt,steps:n})):(a("failed",l.error),w.NextResponse.json({success:!1,error:l.error,steps:n},{status:401}))}e.s(["POST",()=>x],69796);var C=e.i(69796);let R=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/demo/solve/route",pathname:"/api/demo/solve",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/demo/solve/route.ts",nextConfigOutput:"standalone",userland:C}),{workAsyncStorage:S,workUnitAsyncStorage:k,serverHooks:A}=R;function T(){return(0,n.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:k})}async function b(e,t,n){R.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let w="/api/demo/solve/route";w=w.replace(/\/index$/,"")||"/";let v=await R.prepare(e,t,{srcPage:w,multiZoneDraftMode:!1});if(!v)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:x,params:C,nextConfig:S,parsedUrl:k,isDraftMode:A,prerenderManifest:T,routerServerContext:b,isOnDemandRevalidate:E,revalidateOnlyGenerated:j,resolvedPathname:O,clientReferenceManifest:N,serverActionsManifest:I}=v,_=(0,o.normalizeAppPath)(w),$=!!(T.dynamicRoutes[_]||T.routes[O]),P=async()=>((null==b?void 0:b.render404)?await b.render404(e,t,k,!1):t.end("This page could not be found"),null);if($&&!A){let e=!!T.routes[O],t=T.dynamicRoutes[_];if(t&&!1===t.fallback&&!e){if(S.experimental.adapterPath)return await P();throw new y.NoFallbackError}}let U=null;!$||R.isDev||A||(U="/index"===(U=O)?"/":U);let q=!0===R.isDev||!$,D=$&&!q;I&&N&&(0,i.setManifestsSingleton)({page:w,clientReferenceManifest:N,serverActionsManifest:I});let M=e.method||"GET",H=(0,s.getTracer)(),L=H.getActiveScopeSpan(),J={params:C,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!S.experimental.authInterrupts},cacheComponents:!!S.cacheComponents,supportsDynamicResponse:q,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:S.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n,a)=>R.onRequestError(e,t,n,a,b)},sharedContext:{buildId:x}},K=new l.NodeNextRequest(e),F=new l.NodeNextResponse(t),z=c.NextRequestAdapter.fromNodeNextRequest(K,(0,c.signalFromNodeResponse)(t));try{let i=async e=>R.handle(z,J).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=H.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${M} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${w}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var s,l;let c=async({previousCacheEntry:r})=>{try{if(!o&&E&&j&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(a);e.fetchMetrics=J.renderOpts.fetchMetrics;let l=J.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let c=J.renderOpts.collectedTags;if(!$)return await (0,p.sendResponse)(K,F,s,J.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(s.headers);c&&(t[g.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==J.renderOpts.collectedRevalidate&&!(J.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&J.renderOpts.collectedRevalidate,n=void 0===J.renderOpts.collectedExpire||J.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:J.renderOpts.collectedExpire;return{value:{kind:m.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await R.onRequestError(e,t,{routerKind:"App Router",routePath:w,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:E})},!1,b),t}},u=await R.handleResponse({req:e,nextConfig:S,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:E,revalidateOnlyGenerated:j,responseGenerator:c,waitUntil:n.waitUntil,isMinimalMode:o});if(!$)return null;if((null==u||null==(s=u.value)?void 0:s.kind)!==m.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",E?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let y=(0,h.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&$||y.delete(g.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||y.get("Cache-Control")||y.set("Cache-Control",(0,f.getCacheControlHeader)(u.cacheControl)),await (0,p.sendResponse)(K,F,new Response(u.value.body,{headers:y,status:u.value.status||200})),null};L?await l(L):await H.withPropagatedContext(e.headers,()=>H.trace(u.BaseServerSpan.handleRequest,{spanName:`${M} ${w}`,kind:s.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},l))}catch(t){if(t instanceof y.NoFallbackError||await R.onRequestError(e,t,{routerKind:"App Router",routePath:_,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:E})},!1,b),$)throw t;return await (0,p.sendResponse)(K,F,new Response(null,{status:500})),null}}e.s(["handler",()=>b,"patchFetch",()=>T,"routeModule",()=>R,"serverHooks",()=>A,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>k],68581)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__99eb9363._.js.map